<svg viewBox="0 0 1400 900" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <!-- Arrow marker -->
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#333" />
    </marker>
    
    <!-- Skip connection arrow marker -->
    <marker id="skipArrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#E74C3C" />
    </marker>
    
    <!-- Gradient for blocks -->
    <linearGradient id="encoderGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#4A90E2;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#357ABD;stop-opacity:1" />
    </linearGradient>
    
    <linearGradient id="decoderGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#7B68EE;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#6A5ACD;stop-opacity:1" />
    </linearGradient>
    
    <linearGradient id="projGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#FF6B6B;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#E63946;stop-opacity:1" />
    </linearGradient>
    
    <linearGradient id="inputGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#2ECC71;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#27AE60;stop-opacity:1" />
    </linearGradient>
    
    <linearGradient id="outputGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#F39C12;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#E67E22;stop-opacity:1" />
    </linearGradient>
  </defs>
  
  <!-- Title -->
  <text x="700" y="30" font-family="Arial, sans-serif" font-size="22" font-weight="bold" text-anchor="middle" fill="#2C3E50">
    Neural Network Architecture: Compton → GFF Coefficients
  </text>
  
  <!-- Input -->
  <g id="input">
    <rect x="50" y="400" width="80" height="100" rx="5" fill="url(#inputGrad)" stroke="#1E8449" stroke-width="2"/>
    <text x="90" y="440" font-family="Arial" font-size="13" font-weight="bold" text-anchor="middle" fill="white">Input</text>
    <text x="90" y="460" font-family="Arial" font-size="11" text-anchor="middle" fill="white">Compton</text>
    <text x="90" y="475" font-family="Arial" font-size="10" text-anchor="middle" fill="white">(ξ, t)</text>
    <text x="90" y="492" font-family="Courier New" font-size="9" text-anchor="middle" fill="white">[B,1,50,50]</text>
  </g>
  
  <!-- Encoder Block 1 -->
  <g id="enc1">
    <rect x="180" y="390" width="90" height="120" rx="5" fill="url(#encoderGrad)" stroke="#2874A6" stroke-width="2"/>
    <text x="225" y="420" font-family="Arial" font-size="12" font-weight="bold" text-anchor="middle" fill="white">Encoder 1</text>
    <text x="225" y="440" font-family="Arial" font-size="10" text-anchor="middle" fill="white">Conv2D</text>
    <text x="225" y="455" font-family="Arial" font-size="10" text-anchor="middle" fill="white">32 filters</text>
    <text x="225" y="470" font-family="Arial" font-size="10" text-anchor="middle" fill="white">3×3 kernel</text>
    <text x="225" y="492" font-family="Courier New" font-size="9" text-anchor="middle" fill="white">[B,32,50,50]</text>
  </g>
  
  <!-- Encoder Block 2 -->
  <g id="enc2">
    <rect x="310" y="370" width="90" height="140" rx="5" fill="url(#encoderGrad)" stroke="#2874A6" stroke-width="2"/>
    <text x="355" y="400" font-family="Arial" font-size="12" font-weight="bold" text-anchor="middle" fill="white">Encoder 2</text>
    <text x="355" y="420" font-family="Arial" font-size="10" text-anchor="middle" fill="white">MaxPool↓</text>
    <text x="355" y="440" font-family="Arial" font-size="10" text-anchor="middle" fill="white">Conv2D</text>
    <text x="355" y="455" font-family="Arial" font-size="10" text-anchor="middle" fill="white">64 filters</text>
    <text x="355" y="470" font-family="Arial" font-size="10" text-anchor="middle" fill="white">3×3 kernel</text>
    <text x="355" y="495" font-family="Courier New" font-size="9" text-anchor="middle" fill="white">[B,64,25,25]</text>
  </g>
  
  <!-- Encoder Block 3 -->
  <g id="enc3">
    <rect x="440" y="340" width="90" height="160" rx="5" fill="url(#encoderGrad)" stroke="#2874A6" stroke-width="2"/>
    <text x="485" y="370" font-family="Arial" font-size="12" font-weight="bold" text-anchor="middle" fill="white">Encoder 3</text>
    <text x="485" y="390" font-family="Arial" font-size="10" text-anchor="middle" fill="white">MaxPool↓</text>
    <text x="485" y="410" font-family="Arial" font-size="10" text-anchor="middle" fill="white">Conv2D</text>
    <text x="485" y="425" font-family="Arial" font-size="10" text-anchor="middle" fill="white">128 filters</text>
    <text x="485" y="440" font-family="Arial" font-size="10" text-anchor="middle" fill="white">3×3 kernel</text>
    <text x="485" y="485" font-family="Courier New" font-size="9" text-anchor="middle" fill="white">[B,128,12,12]</text>
  </g>
  
  <!-- Bottleneck -->
  <g id="bottleneck">
    <rect x="570" y="310" width="100" height="180" rx="5" fill="#34495E" stroke="#2C3E50" stroke-width="2"/>
    <text x="620" y="340" font-family="Arial" font-size="13" font-weight="bold" text-anchor="middle" fill="white">Bottleneck</text>
    <text x="620" y="360" font-family="Arial" font-size="10" text-anchor="middle" fill="white">MaxPool↓</text>
    <text x="620" y="380" font-family="Arial" font-size="10" text-anchor="middle" fill="white">Conv2D</text>
    <text x="620" y="395" font-family="Arial" font-size="10" text-anchor="middle" fill="white">256 filters</text>
    <text x="620" y="410" font-family="Arial" font-size="10" text-anchor="middle" fill="white">3×3 kernel</text>
    <text x="620" y="425" font-family="Arial" font-size="9" font-style="italic" text-anchor="middle" fill="#FFD700">(Optional)</text>
    <text x="620" y="475" font-family="Courier New" font-size="9" text-anchor="middle" fill="white">[B,256,6,6]</text>
  </g>
  
  <!-- Decoder Block 1 -->
  <g id="dec1">
    <rect x="730" y="340" width="90" height="160" rx="5" fill="url(#decoderGrad)" stroke="#5B2C6F" stroke-width="2"/>
    <text x="775" y="370" font-family="Arial" font-size="12" font-weight="bold" text-anchor="middle" fill="white">Decoder 1</text>
    <text x="775" y="390" font-family="Arial" font-size="10" text-anchor="middle" fill="white">Upsample↑</text>
    <text x="775" y="410" font-family="Arial" font-size="10" text-anchor="middle" fill="white">+Skip Concat</text>
    <text x="775" y="430" font-family="Arial" font-size="10" text-anchor="middle" fill="white">Conv2D</text>
    <text x="775" y="445" font-family="Arial" font-size="10" text-anchor="middle" fill="white">128 filters</text>
    <text x="775" y="485" font-family="Courier New" font-size="9" text-anchor="middle" fill="white">[B,128,12,12]</text>
  </g>
  
  <!-- Decoder Block 2 -->
  <g id="dec2">
    <rect x="860" y="370" width="90" height="140" rx="5" fill="url(#decoderGrad)" stroke="#5B2C6F" stroke-width="2"/>
    <text x="905" y="400" font-family="Arial" font-size="12" font-weight="bold" text-anchor="middle" fill="white">Decoder 2</text>
    <text x="905" y="420" font-family="Arial" font-size="10" text-anchor="middle" fill="white">Upsample↑</text>
    <text x="905" y="440" font-family="Arial" font-size="10" text-anchor="middle" fill="white">+Skip Concat</text>
    <text x="905" y="460" font-family="Arial" font-size="10" text-anchor="middle" fill="white">Conv2D</text>
    <text x="905" y="475" font-family="Arial" font-size="10" text-anchor="middle" fill="white">64 filters</text>
    <text x="905" y="495" font-family="Courier New" font-size="9" text-anchor="middle" fill="white">[B,64,25,25]</text>
  </g>
  
  <!-- Decoder Block 3 -->
  <g id="dec3">
    <rect x="990" y="390" width="90" height="120" rx="5" fill="url(#decoderGrad)" stroke="#5B2C6F" stroke-width="2"/>
    <text x="1035" y="420" font-family="Arial" font-size="12" font-weight="bold" text-anchor="middle" fill="white">Decoder 3</text>
    <text x="1035" y="440" font-family="Arial" font-size="10" text-anchor="middle" fill="white">Upsample↑</text>
    <text x="1035" y="460" font-family="Arial" font-size="10" text-anchor="middle" fill="white">+Skip Concat</text>
    <text x="1035" y="480" font-family="Arial" font-size="10" text-anchor="middle" fill="white">32 filters</text>
    <text x="1035" y="495" font-family="Courier New" font-size="9" text-anchor="middle" fill="white">[B,32,50,50]</text>
  </g>
  
  <!-- Final Conv -->
  <g id="final">
    <rect x="1120" y="400" width="80" height="100" rx="5" fill="#16A085" stroke="#117A65" stroke-width="2"/>
    <text x="1160" y="430" font-family="Arial" font-size="11" font-weight="bold" text-anchor="middle" fill="white">Final</text>
    <text x="1160" y="445" font-family="Arial" font-size="11" font-weight="bold" text-anchor="middle" fill="white">Conv</text>
    <text x="1160" y="465" font-family="Arial" font-size="10" text-anchor="middle" fill="white">1×1 kernel</text>
    <text x="1160" y="480" font-family="Arial" font-size="10" text-anchor="middle" fill="white">2 channels</text>
    <text x="1160" y="492" font-family="Courier New" font-size="9" text-anchor="middle" fill="white">[B,2,50,50]</text>
  </g>
  
  <!-- Projection -->
  <g id="projection">
    <rect x="1240" y="380" width="90" height="140" rx="5" fill="url(#projGrad)" stroke="#C0392B" stroke-width="2"/>
    <text x="1285" y="410" font-family="Arial" font-size="12" font-weight="bold" text-anchor="middle" fill="white">ξ-Projection</text>
    <text x="1285" y="430" font-family="Arial" font-size="10" text-anchor="middle" fill="white">Learnable</text>
    <text x="1285" y="450" font-family="Arial" font-size="10" text-anchor="middle" fill="white">Linear(50→1)</text>
    <text x="1285" y="465" font-family="Arial" font-size="9" text-anchor="middle" fill="white">per coeff</text>
    <text x="1285" y="505" font-family="Courier New" font-size="9" text-anchor="middle" fill="white">[B,2,50<tspan baseline-shift="sub" font-size="7">t</tspan>]</text>
  </g>
  
  <!-- Output -->
  <g id="output">
    <rect x="1360" y="400" width="30" height="100" rx="5" fill="url(#outputGrad)" stroke="#CA6F1E" stroke-width="2"/>
    <text x="1375" y="440" font-family="Arial" font-size="11" font-weight="bold" text-anchor="middle" fill="white" transform="rotate(-90 1375 440)">c₀(t)</text>
    <text x="1375" y="470" font-family="Arial" font-size="11" font-weight="bold" text-anchor="middle" fill="white" transform="rotate(-90 1375 470)">c₂(t)</text>
  </g>
  
  <!-- Forward flow arrows -->
  <line x1="130" y1="450" x2="175" y2="450" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="270" y1="450" x2="305" y2="445" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="400" y1="440" x2="435" y2="425" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="530" y1="420" x2="565" y2="410" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="670" y1="400" x2="725" y2="415" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="820" y1="420" x2="855" y2="435" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="950" y1="440" x2="985" y2="450" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="1080" y1="450" x2="1115" y2="450" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="1200" y1="450" x2="1235" y2="450" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="1330" y1="450" x2="1355" y2="450" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- Skip connections - now clearly separated -->
  <!-- Skip 1: Top path -->
  <path d="M 225 390 L 225 120 L 1035 120 L 1035 390" 
        stroke="#E74C3C" stroke-width="3" fill="none" stroke-dasharray="8,4" marker-end="url(#skipArrow)"/>
  
  <!-- Skip 2: Middle path -->
  <path d="M 355 370 L 355 180 L 905 180 L 905 370" 
        stroke="#E74C3C" stroke-width="3" fill="none" stroke-dasharray="8,4" marker-end="url(#skipArrow)"/>
  
  <!-- Skip 3: Lower path -->
  <path d="M 485 340 L 485 240 L 775 240 L 775 340" 
        stroke="#E74C3C" stroke-width="3" fill="none" stroke-dasharray="8,4" marker-end="url(#skipArrow)"/>
  
  <!-- Skip connection labels -->
  <text x="630" y="110" font-family="Arial" font-size="12" font-weight="bold" text-anchor="middle" fill="#E74C3C">Skip Connection 1</text>
  <text x="630" y="170" font-family="Arial" font-size="12" font-weight="bold" text-anchor="middle" fill="#E74C3C">Skip Connection 2</text>
  <text x="630" y="230" font-family="Arial" font-size="12" font-weight="bold" text-anchor="middle" fill="#E74C3C">Skip Connection 3</text>
  
  <!-- Dimension labels -->
  <text x="700" y="830" font-family="Arial" font-size="13" font-weight="bold" text-anchor="middle" fill="#2C3E50">Spatial Dimensions:</text>
  <text x="700" y="850" font-family="Courier New" font-size="11" text-anchor="middle" fill="#34495E">50×50 → 25×25 → 12×12 → 6×6 → 12×12 → 25×25 → 50×50 → 50×1</text>
  
  <!-- Legend box -->
  <rect x="50" y="650" width="300" height="160" rx="5" fill="#ECF0F1" stroke="#95A5A6" stroke-width="1"/>
  <text x="200" y="675" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle" fill="#2C3E50">Key Features</text>
  
  <text x="60" y="700" font-family="Arial" font-size="11" fill="#34495E">• U-Net encoder-decoder architecture</text>
  <text x="60" y="720" font-family="Arial" font-size="11" fill="#34495E">• Skip connections preserve spatial info</text>
  <text x="60" y="740" font-family="Arial" font-size="11" fill="#34495E">• Full 2D processing until final stage</text>
  <text x="60" y="760" font-family="Arial" font-size="11" fill="#34495E">• Learnable ξ-aggregation (not averaging)</text>
  <text x="60" y="780" font-family="Arial" font-size="11" fill="#34495E">• Output: c₀(t) and c₂(t) coefficients</text>
  <text x="60" y="800" font-family="Arial" font-size="11" fill="#E74C3C">• Red dashed lines: skip connections</text>
  
  <!-- Physics equation box -->
  <rect x="1050" y="650" width="300" height="160" rx="5" fill="#FEF5E7" stroke="#F39C12" stroke-width="2"/>
  <text x="1200" y="675" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle" fill="#E67E22">Physics Context</text>
  
  <text x="1060" y="705" font-family="Arial" font-size="12" fill="#7D6608">Gravitational Form Factor:</text>
  <text x="1200" y="730" font-family="Times New Roman" font-size="14" font-style="italic" text-anchor="middle" fill="#34495E">GFF(ξ, t) = c₀(t) + c₂(t)·ξ²</text>
  
  <text x="1060" y="760" font-family="Arial" font-size="11" fill="#7D6608">Inverse problem: Extract coefficients</text>
  <text x="1060" y="780" font-family="Arial" font-size="11" fill="#7D6608">from Compton amplitude measurements</text>
  <text x="1060" y="800" font-family="Arial" font-size="11" fill="#7D6608">Bottleneck: deepest layer (optional)</text>
</svg>